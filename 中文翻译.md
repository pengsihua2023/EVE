## Disease variant prediction with deep generative models of evolutionary data
## 摘要
量化人类疾病相关基因中蛋白质变异的致病性将对临床决策产生显著影响，然而绝大多数（超过98%）的这些变异仍然未知其后果。理论上，计算方法可以支持遗传变异的大规模解释。然而，最先进的方法依赖于对已知疾病标签的机器学习模型的训练。由于这些标签稀少、有偏见且质量不一，因此生成的模型被认为不够可靠。在这里，我们提出了一种利用深度生成模型预测变异致病性而不依赖于标签的方法。通过建模跨生物体的序列变异分布，我们隐式地捕获了维持适应性的蛋白质序列的约束。我们的模型EVE（变异效应的进化模型）不仅胜过依赖标记数据的计算方法，而且与高通量实验的预测性能相当，如果不是更好的话，这些实验越来越多地被用作变异分类的证据。我们预测了3,219个疾病基因中超过3600万个变异的致病性，并为超过256,000个未知重要性的变异提供了分类证据。我们的工作表明，进化信息模型可以提供有价值的独立证据，用于变异解释，在研究和临床设置中将广泛有用。  

## 正文  
人类基因组测序的指数级增长凸显了人类群体中的显著遗传变异。理解这种遗传变异的疾病相关性有潜力改变医疗保健，并激励了大量投资于收集人类群体基因组信息以及与英国生物银行[1]、中国地图[17]和解码[18]等人口统计和临床数据。测序的可用性使得关联疾病的变异的遗传研究以及关联生化和细胞表型的更多机制性方法成为可能。然而，将基因组中的特定变化与疾病表型联系起来仍然是一个公开的挑战，因为人类群体中的变异数量超过了我们能够研究的数量。仅蛋白编码区就包含人与人之间的大量变异；到目前为止，已观察到650万个错义变异（gnomAD[2]），其中绝大多数（98%）即使在与疾病相关的基因中，其后果也是未知的[3]。估计在几乎80亿人的人群中，每个蛋白质位置（除致死外）都会有一个变异。 

鉴于这一挑战，新的实验技术已经出现，可以同时评估成千上万个突变的影响（有时称为深度突变扫描或多路测序的变异效应（MAVEs））[19,20]。然后，这些高通量实验的结果由如ClinGen[21]等专家小组审查，以对人类变异进行临床解释。然而，这些技术无法轻松扩展到数千种蛋白质，尤其是变异组合，且严重依赖于与人类疾病表型相关或至少与之相关的检测方法。理想情况下，计算也可以加速临床变异的解释。然而，最先进的计算方法[4-10]在监督临床标签的方式上，导致了现实世界预测场景中的准确率膨胀。这种表现的膨胀是由于跨基因的变异聚集（标签偏见）、标签稀疏性、标签噪声[12]和数据泄露[22]（补充说明1）引起的。因此，不足为奇的是，人们对使用计算方法进行变异分类持一定的犹豫态度，正如美国医学遗传学学院和分子病理学协会的指南中所提到的，只作为‘弱证据’[11]。与此相反，单独的进化序列的无监督概率模型在预测变异对蛋白质功能和稳定性的影响方面取得了显著的成功[23-26]，且基本上是可推广的，因为它们避免了从标签中学习。然而，自从早期的开创性努力[27,28]以来，在开发这些模型以解决疾病相关性方面几乎没有进展。  

在本项工作中，我们结合最近在无监督生成建模方面的发展，重新审视了进化信息的临床价值。我们介绍了EVE，一种仅基于进化序列训练的人类遗传变异分类的计算方法。我们展示了EVE在预测变异致病性方面超越了当前最先进的计算方法（没有过度拟合临床标签的风险），并且与高通量实验的预测准确性一样高。  

![image](https://github.com/pengsihua2023/EVE/assets/131550223/ff65927b-5a74-436e-bd17-0f6060cfdde7)  
图 1 | 建模策略。对于每个蛋白质，一个贝叶斯变分自编码器（顶部）学习进化数据中多序列比对（MSA）的氨基酸序列分布。这使得能够计算每个单变异序列的进化指数（左下），该指数近似变异（Xv）与野生型（XWT）序列的负对数似然比。一个全局-局部混合的高斯混合模型（右下）根据该指数将变异分为良性（蓝色虚线）和致病性（红色）簇。模型的结果既是反映致病倾向的连续分数，也是对良性和致病类别的概率分配（分别为蓝色和红色阴影区域），在用户定义的不确定性阈值以下（扩展数据图 1、3）。  
![image](https://github.com/pengsihua2023/EVE/assets/131550223/93ffa6f6-b8ed-47a0-9ce1-2a5949913958)  
图 2 | EVE 准确预测致病变异。a，EVE 分数的 AUC 分布，这些分数是根据 ClinVar 中已知的临床标签计算的，涵盖了我们研究的所有 3,219 个蛋白质（深蓝色）以及至少有五个良性和五个已知致病标签的蛋白质子集（浅蓝色）。
b，EVE 的准确性与不确定性阈值（被设置为‘不确定’的变异百分比）或给定类别分配的变异总数之间的权衡。准确性是根据具有至少三个（五个或十个）良性标签和三个（五个或十个）致病标签的蛋白质的所有标签计算的。
c，EVE 与最先进的计算变异效应预测器的性能比较：七个无监督和八个有监督的。性能是针对已知临床标签估计的（ClinVar 中疾病基因的平均 AUC （x 轴）），以及针对开发用来评估变异的临床效果的高通量功能性测验的（平均斯皮尔曼相关系数（y 轴））（补充说明 2，扩展数据图 4，补充表 2-4）。DMS，深度突变扫描。 

## 从进化预测致病性
我们的方法——EVE——从物种间序列变异的分布中学习人类错义变异的致病倾向（图 1，扩展数据图 1）。在第一步中，我们通过学习每个蛋白质的氨基酸序列分布来捕捉进化过程中自然序列的约束，包括位置之间的复杂依赖关系，这一分布是通过一个表达性强的深度生成模型，即变分自编码器（VAE）[29,30]学到的。VAE在学习多个领域的复杂高维分布方面已经取得了成功，包括预测蛋白质功能31（补充方法）。对于每个感兴趣的人类蛋白质，一个贝叶斯VAE被训练，用于对通过搜索大约2.5亿个蛋白质序列在UniRef32中检索到的多序列比对进行训练（补充方法，补充表 1）。在对进化序列进行训练后，我们通过从VAE学到的近似后验分布中抽样来估计每个单一氨基酸变异相对于野生型的相对可能性——我们称之为“进化指数”。我们进行了彻底的架构和超参数搜索，以确保跨蛋白质的稳定性和性能，并展示了其相较于先前方法31的优越性（扩展数据图 2）。当将这个进化指数与临床标签进行比较时，区分致病与良性标签的值在蛋白质间显著一致（扩展数据图 3a），这表明我们可能使用无监督方法来推断致病性。因此，在第二步中，我们没有使用（半）监督学习将分数映射到标签类别，而是在所有单一氨基酸变异的进化指数分布上拟合了一个双组分全局-局部高斯混合模型（扩展数据图 3b，补充方法）。这一过程的输出既是EVE分数——一个定义在区间[0,1]上的连续致病性分数，其中0最为良性，1最为致病——也是类别分配。对于这些分配，我们使用了高斯混合模型的预测熵作为分类不确定性的度量，并将变异分为三类：良性、不确定或致病（补充方法）。  

我们将EVE应用于与ClinVar3中的疾病相关联的3,219个人类基因（补充方法）。我们的模型对所有标记变异在所有基因上的临床意义具有预测性（平均曲线下面积（AUC）为0.91）（图 2b，补充表 2），包括60个“临床可操作”的基因33（平均AUC为0.92）（扩展数据图 4a）。此外，EVE的性能对于每个蛋白质的标签数量是鲁棒的（图 2b），这表明其可推广性对于注释较少（或没有）的基因，正如我们从一个无监督方法中所期望的。  

EVE 在预测已知临床标签方面胜过所有监督和无监督方法（图 2c，x 轴，补充表 3）。尽管这些标签的很大一部分被用于训练表现最佳的方法，有时甚至被广泛用于定义标签。作为一个避免这些循环逻辑的第二基准，我们比较了模型预测与10种蛋白质中40,000个实验测量的变异（补充方法）。由于这些实验原则上独立于ClinVar标记过程，我们预期这个基准能提供一个较少偏见的性能评估，尽管只涉及比较少量的蛋白质。在这个基准上，EVE 胜过所有方法（图 2c，y 轴，补充表 4），包括元预测器（扩展数据图 4b，补充说明 2，补充方法）。  

由于变异分类的后果从一个基因到另一个基因差异很大，我们方法的一个重要特点是能够为预测分配一个不确定性程度，允许在预测精度和变异覆盖之间进行权衡。将越来越多的变异视为‘不确定’使我们能够在我们确实将其分类为致病或良性的变异上达到更高的精度。例如，排除最不确定的25%的变异后，致病和良性分类的准确度约为90%（图 2b，补充表 2）。实际上，我们设想研究人员会根据基因逐个和使用案例来决定具体的权衡。   

## EVE 的准确性与实验预测相当
我们询问了我们的计算预测是否与实验预测一样准确。对于在 ClinVar 中拥有大量高质量标签的五个基因（BRCA1、TP53、PTEN、MSH2 和 SCN5A），EVE 在预测临床意义方面的整体表现与专门设计来预测致病性的深度突变扫描实验一样好，甚至更好（图 3，扩展数据图 5，补充方法）。例如，对于 TP53，与实验预测相比，EVE 预测了整个蛋白质中良性和致病变异的近乎完美分离，实验预测在四聚体域（从位置300到末端）中较弱14。对于 SCN5A（与布鲁加达综合症34和长QT综合症35相关），尽管这在引用文献36中的实验是功能增益而非功能丧失，EVE 预测 R814Q 为致病性，这表明进化数据包含了关于功能增益的信息，并支持已知的遗传学35。EVE 在更大一组基因上的表现也略优于实验，这些基因的高质量标签较少（扩展数据图 6，补充方法，补充表 5，6）。  

![image](https://github.com/pengsihua2023/EVE/assets/131550223/f18bf254-69bf-499d-96d4-8c13fbda4038)  
图 3 | EVE 在预测临床对变异的解释方面与功能实验一样有效。计算模型预测（左侧面板，y轴 EVE 分数）与实验预测（右侧面板，y轴实验分数）相比较，ClinVar 标签（点）和未知意义的变异（VUS）（叉），其中淡红色和淡蓝色叉表示 EVE 预测；x轴对应于蛋白质中的位置。虚线红色和蓝色线表示将 25% 最不确定的分配视为不确定的 EVE 预测（补充方法）。实验数据来自 TP53（参考文献 13）、PTEN19、MSH2（参考文献 43）和 BRCA1（参考文献 12）的深度突变扫描（扩展数据图 5，补充表 6）。  

由于 EVE 和 MAVEs 是独立的证据来源，比较它们的结果可能有助于评估临床标签本身。在 MSH2、PTEN 和 TP53 中，EVE 分数与 ClinVar 不一致的 27 个变异中的 23 个（85%），MAVE 实验数据支持 EVE 的分类。EVE 和实验都支持 TP53 中的 R337H 和 R337C 变异以及 MSH2 中的 S554N/T、D660G 和 I774V 变异的良性评分，以及 PTEN 中 ClinVar 标记为致病的 15 个变异的评分。同样地，EVE 和实验测定都支持 ClinVar 中标记为良性的 MSH2 中的 G759E 和 E198G 的致病临床效果（后者的致病分类进一步得到新实验数据37的支持）。一个明显的警告是，功能性测定预测和 EVE 之间的一致性可能会误导的情况是功能性 RNA 的情况，例如剪接变异16。  

综合来看，我们的分析显示 EVE 的预测表现与高通量实验的预测一样好，这表明专注于 EVE 表现不佳的基因的实验努力可能是有益的（补充表 7）。  

## 3600万变异的预测
我们为3,219个与疾病相关的基因中的3600万个单一氨基酸变异提供了连续的EVE分数和类别分配。其中，大约130万个变异至今至少在一个人类个体中被观察到（英国生物银行1和gnomAD2；补充方法），但只有大约3%的变异在ClinVar中有任何临床解释（图 4a，左侧）。在剔除最不确定的25%的变异后，EVE的类别分配保持了大约90%的准确率，为总共约2700万个变异提供了解释，其中超过800,000个（大约64%）的变异至今在人类中被观察到（图 4a，中间，补充方法）。  

所有单一氨基酸变异的连续分数为类别分配提供了补充视角。EVE分数在蛋白质内的分布突出了高致病性的簇，遵循可能由功能重要性预期的趋势，例如疏水核心、配体结合位点和活性位点。例如，在SCN4A–SCN1B离子通道复合体（PDB 6AGF38）中，许多具有高EVE分数的变异位于复合体界面，排列在SCN4A孔道和SCN1B的疏水核心（图 4b，c）。对于错配DNA修复复合体MSH2–MSH6（与林奇综合症39相关，约占20%的散发性癌症40），在靠近结合ADP和DNA的位置（PDB 2O8B41）的变异的EVE致病信号很强，尽管临床标签稀少（但在人群中观察到）（图 4d）。  

## 结合EVE与其他证据
EVE提供了一个单一的证据来源，使其非常适合与其他正交的证据来源结合使用（例如，专家小组通常会这样做，如ClinGen21）。为了说明这一点，我们将我们的模型类别分配与gnomAD2的人群数据以及其他现有证据结合。这导致256,000个变异没有先前的临床解释，有可能重新分类，另外539个变异与当前ClinVar状态相矛盾，我们找到了独立的支持证据。后者的例子包括上述的MSH2变异，以及TP53变异R337Q（图4a，补充表8，补充方法）。 

作为一个无监督的方法，也为采用更精细的方法打开了大门，在这种方法中，模型提供的证据强度可以在基因到基因的基础上变化，这与功能性测定的建议42非常相似。这比监督方法有明显优势。例如，如果我们考虑至少有10个标签用于验证的1,000个基因，一个监督方法（使用90%训练，10%测试和随机分割）只留下大约50个蛋白质进行测试（扩展数据图7）。  

![image](https://github.com/pengsihua2023/EVE/assets/131550223/e3e707ec-1367-4b2f-9a32-f44d1d2b6bf5)  
图 4 | 3,219个基因中的变异预测。a, 结合EVE分类与其他证据来源。基于gnomAD和英国生物银行的ClinVar标签和VUS（左）；EVE预测将所有可能变异的25%设置为不确定（中）；以及将EVE与其他证据来源结合后的预测（右）（补充方法；补充表 2）。b, SCN1B中EVE致病性分数的热图。c, d, SCN4A–SCN1B（PDB 6AGF38）（c）和MSH6–MSH2结合ADP和G T错配的三维结构表示（PDB 2O8B41）（d），按位置的平均分数（SCN4A，MSH6和MSH2）和每个位置的最高分数（SCN1B）着色。三维中的高致病性集群包括SCN4A的孔区域，SCN1B的疏水核心（位置40、57、117、119和121），SCN1B的C末端α螺旋和与SCN4A的接口，以及MSH2的ADP结合位点。  

# 讨论
长期以来，人们已经认识到观察物种间序列保守性的模式可以洞察到物种内变异的后果，包括对人类变异和疾病关联的见解。通过结合机器学习的最新发展和来自不同生物的快速增长的测序数据，我们能够得出比以前更精确的声明，并且规模足够大，足以影响我们对变异的临床意义的总体知识。所有数据、结果和代码都可以在 https://evemodel.org/ 上获取或链接（扩展数据图 8），该网站将定期更新新的基因信息。  

我们已经证明，仅基于序列比对训练的深度生成模型在变异分类上达到了最先进的表现，并且避免了通常影响监督方法的问题。这不仅带来了更好的泛化保证，而且还提供了一个独立且互补于其他大规模努力（例如，生物银行的人群数据）的证据来源，并在基因逐一验证时带来了数量级的增益。尽管我们不确切知道从序列中学到的约束如何与疾病相关，但我们观察到的性能与功能性测验在预测致病性方面不相上下。这表明专家小组可以对我们的方法进行与MAVEs等实验相似的审查。  

我们的方法相对于实验方法的主要优势是在成本几乎可以忽略不计的情况下显著增加了范围。一个吸引人的前景是，我们的方法可能有助于指导未来的实验努力，本质上作为识别哪些变异和哪些基因最有信息量进行探测的手段（补充表 7）。  

评估错义变异的重要挑战有一些未在本报告中涉及。首先，是疾病表现的异质性；我们知道，同一个基因的不同变异，甚至同一个变异，可能导致不同的疾病严重性甚至不同的疾病，这些方面将被简单的离散病理分类掩盖。尽管我们预期连续的EVE分数，与离散分类相比，可能有助于预测疾病严重性，这仍然是推测性的，且不考虑同一基因中变异导致的完全不同的疾病表现。其次，当前工作没有明确解决变异组合的效应。由于人类平均约有12%的基因与参考基因组相比有两个或更多的变异，尽管不一定在同一染色体上，这将是一个重要的考虑因素。对于“ACMG行动基因”，在同一个基因中有大约21,000对不同的变异组合，出现了1.5百万次（英国生物银行1；扩展数据图 9，补充方法，补充表 9）。  

我们以生物多样性的意义结束本讨论。我们的分析是如何利用地球上生命的多样性对人类健康有益的一个小但非常直接的示例。我们的模型使用了来自超过140,000个生物的数据。其中，我们确认了17,000个生物存在于国际自然保护联盟濒危物种红色名录上，包括1,301个分类为易危，1,148个濒危，548个极危，10个野外灭绝和21个已灭绝的物种。物种的逐渐消失对本工作所依赖的多样性构成了威胁。  

## Data availability
The data analysed and generated in this study, including multiple sequence alignments used in training, ClinVar annotations used for validation, population frequencies and predictions from our model, are
available in Supplementary Information and at evemodel.org. Predictions from other computational models are available through http://database. liulab.science/dbNSFP. Source data are provided with this paper.  
## Code availability
The model code is available at https://github.com/OATML-Markslab/EVE, https://doi.org/10.5281/zenodo.5389490.  







